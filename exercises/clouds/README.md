# Облака

Amazon Web Services (AWS) — коммерческое публичное облако, поддерживаемое и развиваемое компанией Amazon.

Amazon Simple Storage Service (Amazon S3) – это сервис хранения объектов (архивов, исполняемых файлов, css, html, картинки и т.д.) любых размеров.

Amazon CloudFront — веб-сервис для доставки контента. Он позволяет доставлять пользователям по всему миру контент с высокой скоростью и доступностью, также предоставляет кеширование.

Используя сервисы S3 и CloundFornt разверните статическую страничку в облаке

## Ссылки

* [Amazon Web Services](https://aws.amazon.com/ru/).
* [What is the AWS Command Line Interface?](https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-welcome.html)
* [Deliver Content Faster](https://aws.amazon.com/ru/getting-started/hands-on/deliver-content-faster/)

## Задачи

В директории *public/* хранится HTML-файл со статьей, файлы стилей и картинка. Необходимо содержимое этой директории выложить на S3 и настроить раздачу с помощью Cloudfront.

* Зарегистрируйтесь в [AWS](https://aws.amazon.com/ru/). Первые 12 месяцев бесплатное пользование, но необходимо подтвердить почту, введя карту (снимут и вернут 1$). Также требуется указание почтового адреса, подтверждение номера телефона (лучше мобильный).
* Войдите в [консоль AWS](https://eu-central-1.console.aws.amazon.com/console/home?region=eu-central-1). Найдите в ней сервис S3
* Создайте новый бакет (bucket) в S3. Нажимайте на Create bucket
  * Дайте имя, например *clouds-homework-<username>*
  * Регион - любой
  * Остальные опции нас пока не интересуют
* Теперь необходимо загрузить файлы в бакет и сделать их публичными
  * Перейдите в бакет, кликнув на название.
    * Загрузите *index.html* кликнув по *Add files*
    * Загрузите *css*, *assets* нажав *Add folder* добавив каждую директорию
    * Остальные опции нас не интересуют, нажмите UploadМы залили файлы на AWS. Хотя S3 это облачное хранилище файлов, мы можем использовать его как хостинг для статических приложений. Для этого заходим в *Properties*, в Самому низу в разделе *Static website hosting* редактируем настройки. Здесь необходимо указать корневой файл *index.html*
* Теперь в разделе настроек *Static website hosting* отображает
* ся ссылка вида *https://<bucket_name>.s3.eu-central-1.amazonaws.com/index.html* Но при её открытии возникает ошибка доступа. Дело в том, что по умолчанию все файлы приватны, даже когда включен веб-хостинг.
  * Зайдите во вкладку Permissions. Здесь в разделе *Block public access (bucket settings)* необходимо отключить блокировку публичного доступа.
  * На вкладке *Objects* отметьте все файлы. В меню *Actions* седлайте все файлы публичными.
  * Добавьте Bucket policy, это нужно, чтобы не было ошибок доступа на CloudFront:

    ```json
    {
      "Version": "2012-10-17",
      "Statement": [
        {
          "Sid": "PublicRead",
          "Effect": "Allow",
          "Principal": "*",
          "Action": [
              "s3:GetObject"
          ],
          "Resource": [
              "arn:aws:s3:::clouds-homework",
              "arn:aws:s3:::clouds-homework/*"
          ]
        }
      ]
    }
    ```

  * Теперь наш сайт доступен по ссылке вида *http://clouds-homework.s3-website.eu-central-1.amazonaws.com/*

Теперь мы можем раздавать наше приложение с помощью Cloudfront. Найдите сервис в консоли AWS

* Создайте новый CloudFront Distribution
  * Origin Domain Name - здесь необходимо выбрать бакет S3, который был создан ранее
  * Оставшиеся настройки нас не интересуют в данный момент. Изучите их самостоятельно.
* Созданная дистрибуция будет находиться какое-то время в статусе *InProgress*. Это может занять несколько минут. Сайт будет доступен, когда состояние будет *Deployed*
* Укажите Default root object, в настройках дистрибуции. Это нужно для того, чтобы при запросе корневого URL (/) происходил редирект и вместо него открывалась страница */index.html*.
* Найдите домен с которого раздается статика. Нажмите на ID дистрибуции и найти домен вида *abca12345.cloudfront.net*

* В файле *solution* добавьте ссылку на задеплоенное приложение: http://<адрес>
